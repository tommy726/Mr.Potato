(function(){"use strict";var t={5764:function(t,e,o){var a=o(6216),s=o(5708),n=o(3990),r=o(579),c=o(2389),i=o(6423),u=o(4161),d=o(6905),p=o.n(d),m=o(9242),l=o(3396),h=o.p+"img/loading.fe733dbc.gif";const g=(0,l._)("div",null,[(0,l._)("img",{src:h,alt:"loading"})],-1);function f(t,e,o,a,s,n){const r=(0,l.up)("IsLoading"),c=(0,l.up)("AlertMessage"),i=(0,l.up)("RouterView");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(r,{active:t.$store.state.isLoading},{default:(0,l.w5)((()=>[g])),_:1},8,["active"]),(0,l.Wm)(c),(0,l.Wm)(i)])}var v=o(65),b=o(7139);const P={class:"message-alert"},M=["onClick"];function C(t,e,o,a,s,n){return(0,l.wg)(),(0,l.iD)("div",P,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.messages,((t,e)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,b.C_)(["alert alert-dismissible",`alert-${t.apiStatus}`]),key:e},[(0,l.Uk)((0,b.zw)(t.message)+" ",1),(0,l._)("button",{type:"button",class:"btn-close",onClick:t=>n.removeMessage(e),"aria-label":"Close"},null,8,M)],2)))),128))])}var O={name:"AlertMessage",computed:{...(0,v.Se)("alertModules",["messages"])},methods:{removeMessage(t){this.$store.dispatch("alertModules/removeMessage",t)}}},S=o(89);const y=(0,S.Z)(O,[["render",C]]);var A=y,_={name:"App",components:{AlertMessage:A},computed:{...(0,v.Se)(["isLoading"])},created(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=`${t}`}};const D=(0,S.Z)(_,[["render",f]]);var T=D,E=t=>{const e=Number(t);return`$${e.toFixed(0).replace(/./g,((t,e,o)=>{const a=e&&"."!==t&&(o.length-e)%3===0?`, ${t}`.replace(/\s/g,""):t;return a}))}`},L=t=>{const e=new Date(1e3*t);return e.toLocaleDateString()},I=o(2483);const x=[{path:"/",name:"CustomerIndex",component:()=>Promise.all([o.e(166),o.e(40)]).then(o.bind(o,7040)),children:[{path:"",name:"CustomerHome",component:()=>o.e(31).then(o.bind(o,6462))},{path:"login",name:"LoginPage",component:()=>o.e(963).then(o.bind(o,1963))},{path:"signup",name:"SignupPage",component:()=>o.e(709).then(o.bind(o,7709))},{path:"product_list/:productCategory",name:"ProductList",component:()=>o.e(569).then(o.bind(o,9569))},{path:"favorite",name:"FavoriteProduct",component:()=>o.e(36).then(o.bind(o,1036))},{path:"product_page/:productId",name:"ProductPage",component:()=>o.e(34).then(o.bind(o,4034))},{path:"check_cart",name:"CustomerOrder",component:()=>o.e(959).then(o.bind(o,2959)),children:[{path:"",name:"CheckCart",component:()=>o.e(416).then(o.bind(o,3416))},{path:"/customer_info",name:"CustomerInfo",component:()=>o.e(950).then(o.bind(o,950))},{path:"/checkouts/:orderId",name:"CustomerCheckouts",component:()=>o.e(171).then(o.bind(o,7171))},{path:"/order_complete",name:"OrderComplete",component:()=>o.e(441).then(o.bind(o,2441))}]}]},{path:"/admin",name:"AdminDashboard",component:()=>Promise.all([o.e(166),o.e(162)]).then(o.bind(o,2162)),meta:{requiresAuth:!0},children:[{path:"products",name:"AdminProducts",component:()=>Promise.all([o.e(166),o.e(70)]).then(o.bind(o,4070))},{path:"orders",name:"AdminOrders",component:()=>Promise.all([o.e(166),o.e(371)]).then(o.bind(o,8371))},{path:"coupons",name:"AdminCoupons",component:()=>Promise.all([o.e(166),o.e(269)]).then(o.bind(o,9269))}]},{path:"/:pathMatch(.*)*",redirect:{name:"CustomerHome"}}],k=(0,I.p7)({history:(0,I.r5)("/Mr.Potato/"),routes:x});k.beforeEach(((t,e,o)=>{if(t.meta.requiresAuth){const t="https://vue-course-api.hexschool.io/api/user/check";u.Z.post(t).then((t=>{t.data.success?o():o({path:"/login"})})).catch((()=>{o({path:"/"})}))}else o()}));var w=k,N={namespaced:!0,state:{cart:{carts:[]},couponData:JSON.parse(localStorage.getItem("couponData"))||[]},actions:{getCart(t){t.commit("LOADING",!0,{root:!0});const e="https://vue-course-api.hexschool.io/api/tommy726/cart";u.Z.get(e).then((e=>{0===e.data.data.carts.length&&t.dispatch("changeCouponStatus",{status:!1,code:""}),t.commit("CART",e.data.data),t.commit("LOADING",!1,{root:!0})})).catch((()=>{t.dispatch("alertModules/updateMessage",{message:"資料取得失敗，請確認api是否正確",status:!1})}))},removeCart(t,e){const o=`https://vue-course-api.hexschool.io/api/tommy726/cart/${e}`;t.commit("LOADING",!0,{root:!0}),u.Z["delete"](o).then((e=>{t.dispatch("alertModules/updateMessage",{message:e.data.message,status:e.data.success},{root:!0}),t.dispatch("getCart"),t.commit("LOADING",!1,{root:!0})})).catch((()=>{t.dispatch("alertModules/updateMessage",{message:"資料取得失敗，請確認api是否正確",status:!1})}))},addToCartFn(t,{id:e,qty:o}){const a="https://vue-course-api.hexschool.io/api/tommy726/cart";t.commit("LOADING",!0,{root:!0});const s={product_id:e,qty:o};u.Z.post(a,{data:s}).then((e=>{t.dispatch("alertModules/updateMessage",{message:"已更新購物車",status:e.data.success},{root:!0}),t.dispatch("getCart"),t.commit("LOADING",!1,{root:!0})})).catch((()=>{t.dispatch("alertModules/updateMessage",{message:"資料取得失敗，請確認api是否正確",status:!1})}))},addToCart(t,{id:e,qty:o}){const a=t.state.cart.carts,s=a.findIndex((t=>t.product_id===e));-1!==s?t.dispatch("updateCart",{id:e,qty:a[s].qty+o,cartId:a[s].id}):t.dispatch("addToCartFn",{id:e,qty:o})},updateCart(t,{id:e,qty:o,cartId:a}){const s=`https://vue-course-api.hexschool.io/api/tommy726/cart/${a}`;u.Z["delete"](s).then((()=>{t.dispatch("getCart"),t.commit("LOADING",!1,{root:!0})})).catch((()=>{t.dispatch("alertModules/updateMessage",{message:"資料取得失敗，請確認api是否正確",status:!1})})),0!==o&&t.dispatch("addToCartFn",{id:e,qty:o})},changeCouponStatus({state:t,commit:e},{status:o,code:a}){e("COUPON_DATA",{status:o,code:a}),localStorage.setItem("couponData",JSON.stringify(t.couponData))}},mutations:{CART(t,e){t.cart=e},COUPON_DATA(t,e){t.couponData=e}},getters:{cart:t=>t.cart,couponData:t=>t.couponData},module:{}},j=(o(7658),{namespaced:!0,state:{messages:[]},actions:{updateMessage(t,{message:e,status:o}){const a=Math.floor(new Date/1e3);let s="";s=o?"success":"danger";const n={message:e,apiStatus:s,timestamp:a};t.commit("PUSH_MESSAGES",n),t.dispatch("removeMessageWithTiming",a)},removeMessage(t,e){t.commit("REMOVE_MESSAGE",e)},removeMessageWithTiming(t,e){setTimeout((()=>{t.commit("MESSAGE_TIME",e)}),3e3)}},mutations:{PUSH_MESSAGES(t,e){t.messages.push(e)},REMOVE_MESSAGE(t,e){t.messages.splice(e,1)},MESSAGE_TIME(t,e){t.messages.forEach(((o,a)=>{o.timestamp===e&&t.messages.splice(a,1)}))}},getters:{messages:t=>t.messages}}),G={namespaced:!0,state:{filterProducts:[],lunchBoxProducts:[],saladProducts:[],favoriteProducts:JSON.parse(localStorage.getItem("favoriteProducts"))||[]},actions:{getProducts(t){t.dispatch("updateLoading",!0,{root:!0});const e="https://vue-course-api.hexschool.io/api/tommy726/products/all";u.Z.get(e).then((e=>{const o=e.data.products.filter((t=>1===t.is_enabled));t.commit("FILTER_PRODUCTS",o),t.dispatch("getLunchBoxProducts"),t.dispatch("getSaladProducts"),t.dispatch("updateLoading",!1,{root:!0})})).catch((()=>{t.dispatch("alertModules/updateMessage",{message:"資料取得失敗，請確認api是否正確",status:!1})}))},getLunchBoxProducts({state:t,commit:e}){const o=t.filterProducts.filter((t=>t.price>=100));e("LUNCH_BOX_PRODUCTS",o)},getSaladProducts({state:t,commit:e}){const o=t.filterProducts.filter((t=>"純素主義"===t.category));e("SALAD_PRODUCTS",o)},addToFavorite({state:t,dispatch:e},{id:o,item:a}){if(t.favoriteProducts.includes(o)){const a=t.favoriteProducts.findIndex((t=>t===o));t.favoriteProducts.splice(a,2),e("alertModules/updateMessage",{message:"已從收藏中刪除",status:!1},{root:!0})}else t.favoriteProducts.push(o,a),e("alertModules/updateMessage",{message:"已加入收藏",status:!0},{root:!0});localStorage.setItem("favoriteProducts",JSON.stringify(t.favoriteProducts))}},mutations:{FILTER_PRODUCTS(t,e){t.filterProducts=e},LUNCH_BOX_PRODUCTS(t,e){t.lunchBoxProducts=e},SALAD_PRODUCTS(t,e){t.saladProducts=e}},getters:{filterProducts:t=>t.filterProducts,lunchBoxProducts:t=>t.lunchBoxProducts,saladProducts:t=>t.saladProducts,favoriteProducts:t=>t.favoriteProducts},module:{}},U=(0,v.MT)({state:{isLoading:!1},actions:{updateLoading(t,e){t.commit("LOADING",e)}},mutations:{LOADING(t,e){t.isLoading=e}},getters:{},modules:{cartsModules:N,alertModules:j,productsModules:G}});Object.keys(n.ZP).forEach((t=>{(0,s.aH)(t,n.ZP[t])})),(0,s.jQ)({generateMessage:(0,r.NC)({zh_TW:c}),validateOnInput:!0}),(0,r.i_)("zh_TW");const Z=(0,m.ri)(T);Z.config.globalProperties.$filters={currency:E,date:L},Z.component("IsLoading",a.Z).component("Form",s.l0).component("Field",s.gN).use(U).use(w).use(i.Z,u.Z).mount("#app"),u.Z.defaults.withCredentials=!0,p().init()}},e={};function o(a){var s=e[a];if(void 0!==s)return s.exports;var n=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=t,function(){o.amdO={}}(),function(){var t=[];o.O=function(e,a,s,n){if(!a){var r=1/0;for(d=0;d<t.length;d++){a=t[d][0],s=t[d][1],n=t[d][2];for(var c=!0,i=0;i<a.length;i++)(!1&n||r>=n)&&Object.keys(o.O).every((function(t){return o.O[t](a[i])}))?a.splice(i--,1):(c=!1,n<r&&(r=n));if(c){t.splice(d--,1);var u=s();void 0!==u&&(e=u)}}return e}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[a,s,n]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var a in e)o.o(e,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){o.f={},o.e=function(t){return Promise.all(Object.keys(o.f).reduce((function(e,a){return o.f[a](t,e),e}),[]))}}(),function(){o.u=function(t){return"js/"+t+"."+{31:"c1d839df",34:"26428093",36:"26c002b0",40:"0e7a92e5",70:"bddf5bd9",162:"8503c8bb",166:"88ed9b85",171:"ad223a02",269:"d9d535fa",371:"791edcb0",416:"b318d14c",441:"e6ce4f87",569:"ac656b3a",709:"fe65b511",950:"0b141eba",959:"41cf7906",963:"8fbcd6ea"}[t]+".js"}}(),function(){o.miniCssF=function(t){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="mrpotato:";o.l=function(a,s,n,r){if(t[a])t[a].push(s);else{var c,i;if(void 0!==n)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var p=u[d];if(p.getAttribute("src")==a||p.getAttribute("data-webpack")==e+n){c=p;break}}c||(i=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.setAttribute("data-webpack",e+n),c.src=a),t[a]=[s];var m=function(e,o){c.onerror=c.onload=null,clearTimeout(l);var s=t[a];if(delete t[a],c.parentNode&&c.parentNode.removeChild(c),s&&s.forEach((function(t){return t(o)})),e)return e(o)},l=setTimeout(m.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=m.bind(null,c.onerror),c.onload=m.bind(null,c.onload),i&&document.head.appendChild(c)}}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.p="/Mr.Potato/"}(),function(){var t={143:0};o.f.j=function(e,a){var s=o.o(t,e)?t[e]:void 0;if(0!==s)if(s)a.push(s[2]);else{var n=new Promise((function(o,a){s=t[e]=[o,a]}));a.push(s[2]=n);var r=o.p+o.u(e),c=new Error,i=function(a){if(o.o(t,e)&&(s=t[e],0!==s&&(t[e]=void 0),s)){var n=a&&("load"===a.type?"missing":a.type),r=a&&a.target&&a.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",c.name="ChunkLoadError",c.type=n,c.request=r,s[1](c)}};o.l(r,i,"chunk-"+e,e)}},o.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,n,r=a[0],c=a[1],i=a[2],u=0;if(r.some((function(e){return 0!==t[e]}))){for(s in c)o.o(c,s)&&(o.m[s]=c[s]);if(i)var d=i(o)}for(e&&e(a);u<r.length;u++)n=r[u],o.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return o.O(d)},a=self["webpackChunkmrpotato"]=self["webpackChunkmrpotato"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(5764)}));a=o.O(a)})();
//# sourceMappingURL=app.bd0707a3.js.map